{"ast":null,"code":"var _jsxFileName = \"/home/amr/IdeaProjects/scalable-push-notification/push-notification-client/src/App.js\";\nimport React, { Component } from \"react\";\nimport { Icon, Popover, Badge, List, notification } from \"antd\";\nimport \"antd/dist/antd.css\";\nimport \"./App.css\";\n\nclass App extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      newNotifications: [],\n      notifications: []\n    };\n\n    this.componentDidMount = () => {\n      this.initListener();\n    };\n\n    this.initListener = () => {\n      const eventSource = new EventSource(\"http://localhost:8080/subscription\");\n\n      eventSource.onopen = e => console.log(\"open\");\n\n      eventSource.onerror = e => {\n        if (e.readyState == EventSource.CLOSED) {\n          console.log(\"close\");\n        } else {\n          console.log(e);\n        }\n\n        this.initListener();\n      };\n\n      eventSource.addEventListener(\"amrkhaled\", e => {\n        console.log(\"amrkhaled\", e.data);\n        const json = JSON.parse(e.data);\n        let newNotifications = this.state.newNotifications;\n        newNotifications.unshift({\n          name: json.name,\n          msg: json.msg,\n          isRead: false\n        });\n        this.setState({\n          newNotifications: newNotifications\n        });\n        notification.config({\n          placement: \"bottomLeft\"\n        });\n        notification.open({\n          message: React.createElement(\"div\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 47\n            },\n            __self: this\n          }, React.createElement(\"b\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 48\n            },\n            __self: this\n          }, json.name), \" \", json.msg)\n        });\n      }, false);\n    };\n\n    this.handleOnClick = () => {\n      let notifications = this.state.notifications;\n      notifications = this.state.newNotifications.concat(notifications);\n      console.log(notifications);\n      this.setState({\n        newNotifications: [],\n        notifications: notifications\n      });\n    };\n\n    this.handleItemClick = notification => {\n      const notifications = this.state.notifications.map(item => {\n        if (item == notification) item.isRead = true;\n        return item;\n      });\n      this.setState({\n        notifications\n      });\n    };\n  }\n\n  render() {\n    let iconClass = \"icon-dimmed\";\n\n    if (this.state.newNotifications.length > 0) {\n      iconClass = \"icon-active\";\n    }\n\n    const text = React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80\n      },\n      __self: this\n    }, React.createElement(\"b\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81\n      },\n      __self: this\n    }, \"Notifications\"));\n    const content = React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    }, React.createElement(List, {\n      dataSource: this.state.notifications,\n      renderItem: notification => React.createElement(List.Item, {\n        className: notification.isRead ? \"item-read\" : \"item-not-read\",\n        onClick: () => this.handleItemClick(notification),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        style: {\n          padding: \"2px 20px\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93\n        },\n        __self: this\n      }, React.createElement(\"b\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94\n        },\n        __self: this\n      }, notification.name), \" \", notification.msg)),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86\n      },\n      __self: this\n    }));\n    return React.createElement(\"div\", {\n      className: \"App\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"menuBar\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"logo\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      href: \"#\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }, \"Push Notification\")), React.createElement(\"div\", {\n      className: \"menuCon\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"rightMenu\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      href: \"#\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      className: \"icon-dimmed\",\n      type: \"home\",\n      theme: \"filled\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    })), React.createElement(\"a\", {\n      href: \"#\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      className: \"icon-dimmed\",\n      type: \"message\",\n      theme: \"filled\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114\n      },\n      __self: this\n    })), React.createElement(\"a\", {\n      href: \"#\",\n      onClick: this.handleOnClick,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    }, React.createElement(Popover, {\n      placement: \"bottomRight\",\n      title: text,\n      content: content,\n      trigger: \"click\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }, React.createElement(Badge, {\n      offset: [-2, 10],\n      count: this.state.newNotifications.length,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      className: iconClass,\n      type: \"bell\",\n      theme: \"filled\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }))))))));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/home/amr/IdeaProjects/scalable-push-notification/push-notification-client/src/App.js"],"names":["React","Component","Icon","Popover","Badge","List","notification","App","state","newNotifications","notifications","componentDidMount","initListener","eventSource","EventSource","onopen","e","console","log","onerror","readyState","CLOSED","addEventListener","data","json","JSON","parse","unshift","name","msg","isRead","setState","config","placement","open","message","handleOnClick","concat","handleItemClick","map","item","render","iconClass","length","text","content","padding"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { Icon, Popover, Badge, List, notification } from \"antd\";\nimport \"antd/dist/antd.css\";\nimport \"./App.css\";\n\nclass App extends Component {\n  state = {\n    newNotifications: [],\n    notifications: []\n  };\n\n  componentDidMount = () => {\n    this.initListener();\n  };\n\n  initListener = () => {\n    const eventSource = new EventSource(\"http://localhost:8080/subscription\");\n    eventSource.onopen = e => console.log(\"open\");\n    eventSource.onerror = e => {\n      if (e.readyState == EventSource.CLOSED) {\n        console.log(\"close\");\n      } else {\n        console.log(e);\n      }\n      this.initListener();\n    };\n    eventSource.addEventListener(\n      \"amrkhaled\",\n      e => {\n        console.log(\"amrkhaled\", e.data);\n        const json = JSON.parse(e.data);\n        let newNotifications = this.state.newNotifications;\n        newNotifications.unshift({\n          name: json.name,\n          msg: json.msg,\n          isRead: false\n        });\n\n        this.setState({ newNotifications: newNotifications });\n\n        notification.config({\n          placement: \"bottomLeft\"\n        });\n\n        notification.open({\n          message: (\n            <div>\n              <b>{json.name}</b> {json.msg}\n            </div>\n          )\n        });\n      },\n      false\n    );\n  };\n\n  handleOnClick = () => {\n    let notifications = this.state.notifications;\n    notifications = this.state.newNotifications.concat(notifications);\n    console.log(notifications);\n    this.setState({ newNotifications: [], notifications: notifications });\n  };\n\n  handleItemClick = notification => {\n    const notifications = this.state.notifications.map(item => {\n      if (item == notification) item.isRead = true;\n      return item;\n    });\n\n    this.setState({ notifications });\n  };\n  render() {\n    let iconClass = \"icon-dimmed\";\n\n    if (this.state.newNotifications.length > 0) {\n      iconClass = \"icon-active\";\n    }\n\n    const text = (\n      <span>\n        <b>Notifications</b>\n      </span>\n    );\n    const content = (\n      <div>\n        <List\n          dataSource={this.state.notifications}\n          renderItem={notification => (\n            <List.Item\n              className={notification.isRead ? \"item-read\" : \"item-not-read\"}\n              onClick={() => this.handleItemClick(notification)}\n            >\n              <span style={{ padding: \"2px 20px\" }}>\n                <b>{notification.name}</b> {notification.msg}\n              </span>\n            </List.Item>\n          )}\n        />\n      </div>\n    );\n\n    return (\n      <div className=\"App\">\n        <div className=\"menuBar\">\n          <div className=\"logo\">\n            <a href=\"#\">Push Notification</a>\n          </div>\n          <div className=\"menuCon\">\n            <div className=\"rightMenu\">\n              <a href=\"#\">\n                <Icon className=\"icon-dimmed\" type=\"home\" theme=\"filled\" />\n              </a>\n              <a href=\"#\">\n                <Icon className=\"icon-dimmed\" type=\"message\" theme=\"filled\" />\n              </a>\n              <a href=\"#\" onClick={this.handleOnClick}>\n                <Popover\n                  placement=\"bottomRight\"\n                  title={text}\n                  content={content}\n                  trigger=\"click\"\n                >\n                  <Badge\n                    offset={[-2, 10]}\n                    count={this.state.newNotifications.length}\n                  >\n                    <Icon className={iconClass} type=\"bell\" theme=\"filled\" />\n                  </Badge>\n                </Popover>\n              </a>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}